asyncapi: 3.0.0
info:
  title: Kafka test
  version: '1'
servers:
  mykafka:
    host: kafka://pkc-6ojv2.us-west4.gcp.confluent.cloud:9092
    protocol: kafka-secure
    security:
      - $ref: '#/components/securitySchemes/saslScramExample'
      # - saslScramExample: []
      - $ref: '#/components/securitySchemes/saslScramExample2'
channels:
  test:
    # address: null
    messages:
      testMessage:
        $ref: '#/components/messages/testMessage'
  produce:
    messages:
      produceMessage:
        $ref: '#/components/messages/testMessage'
operations: 
  onTest:
    title: Test Kafka Connection
    summary: Publish messages to Test channel.
    # description: A longer description
    channel:
      $ref: "#/channels/test"
    action: send
    reply:
      address: 
        location: "$message.header#/replyTo"
      channel: 
        $ref: '#/channels/produce'
  
  onProduce:
    title: Test Kafka Connection
    summary: Recieve messages from Produce channel.
    # description: A longer description
    channel:
      $ref: "#/channels/produce"
    action: receive
  
components:
  messages:
    testMessage:
      payload:
        type: object
        properties:
          test:
            type: string 
  securitySchemes:
      saslScramExample:
        type: scramSha256
      userPass:
        type: userPassword
      saslScramExample2:
        type: scramSha256
